import{initEnv as t,inBiliApp as e,biliBridge as n,isSupport as r}from"@bilibili/js-bridge";var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t,e){return t(e={exports:{}},e.exports),e.exports}var c,u,a=function(t){return t&&t.Math==Math&&t},s=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof o&&o)||function(){return this}()||Function("return this")(),f=function(t){try{return!!t()}catch(t){return!0}},l=!f((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),p=!f((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),d=Function.prototype.call,h=p?d.bind(d):function(){return d.apply(d,arguments)},v={}.propertyIsEnumerable,m=Object.getOwnPropertyDescriptor,b={f:m&&!v.call({1:2},1)?function(t){var e=m(this,t);return!!e&&e.enumerable}:v},y=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},g=Function.prototype,w=g.bind,O=g.call,S=p&&w.bind(O,O),j=p?function(t){return t&&S(t)}:function(t){return t&&function(){return O.apply(t,arguments)}},E=j({}.toString),P=j("".slice),x=function(t){return P(E(t),8,-1)},T=Object,R=j("".split),C=f((function(){return!T("z").propertyIsEnumerable(0)}))?function(t){return"String"==x(t)?R(t,""):T(t)}:T,I=TypeError,_=function(t){if(null==t)throw I("Can't call method on "+t);return t},A=function(t){return C(_(t))},M=function(t){return"function"==typeof t},U=function(t){return"object"==typeof t?null!==t:M(t)},N=function(t){return M(t)?t:void 0},k=function(t,e){return arguments.length<2?N(s[t]):s[t]&&s[t][e]},L=j({}.isPrototypeOf),F=k("navigator","userAgent")||"",B=s.process,D=s.Deno,q=B&&B.versions||D&&D.version,W=q&&q.v8;W&&(u=(c=W.split("."))[0]>0&&c[0]<4?1:+(c[0]+c[1])),!u&&F&&(!(c=F.match(/Edge\/(\d+)/))||c[1]>=74)&&(c=F.match(/Chrome\/(\d+)/))&&(u=+c[1]);var z=u,Q=!!Object.getOwnPropertySymbols&&!f((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&z&&z<41})),G=Q&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,K=Object,X=G?function(t){return"symbol"==typeof t}:function(t){var e=k("Symbol");return M(e)&&L(e.prototype,K(t))},Y=String,V=function(t){try{return Y(t)}catch(t){return"Object"}},$=TypeError,H=function(t){if(M(t))return t;throw $(V(t)+" is not a function")},J=function(t,e){var n=t[e];return null==n?void 0:H(n)},Z=TypeError,tt=Object.defineProperty,et=function(t,e){try{tt(s,t,{value:e,configurable:!0,writable:!0})}catch(n){s[t]=e}return e},nt=s["__core-js_shared__"]||et("__core-js_shared__",{}),rt=i((function(t){(t.exports=function(t,e){return nt[t]||(nt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.5",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.5/LICENSE",source:"https://github.com/zloirock/core-js"})})),ot=Object,it=j({}.hasOwnProperty),ct=Object.hasOwn||function(t,e){return it(ot(_(t)),e)},ut=0,at=Math.random(),st=j(1..toString),ft=function(t){return"Symbol("+(void 0===t?"":t)+")_"+st(++ut+at,36)},lt=rt("wks"),pt=s.Symbol,dt=pt&&pt.for,ht=G?pt:pt&&pt.withoutSetter||ft,vt=function(t){if(!ct(lt,t)||!Q&&"string"!=typeof lt[t]){var e="Symbol."+t;Q&&ct(pt,t)?lt[t]=pt[t]:lt[t]=G&&dt?dt(e):ht(e)}return lt[t]},mt=TypeError,bt=vt("toPrimitive"),yt=function(t,e){if(!U(t)||X(t))return t;var n,r=J(t,bt);if(r){if(void 0===e&&(e="default"),n=h(r,t,e),!U(n)||X(n))return n;throw mt("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var n,r;if("string"===e&&M(n=t.toString)&&!U(r=h(n,t)))return r;if(M(n=t.valueOf)&&!U(r=h(n,t)))return r;if("string"!==e&&M(n=t.toString)&&!U(r=h(n,t)))return r;throw Z("Can't convert object to primitive value")}(t,e)},gt=function(t){var e=yt(t,"string");return X(e)?e:e+""},wt=s.document,Ot=U(wt)&&U(wt.createElement),St=function(t){return Ot?wt.createElement(t):{}},jt=!l&&!f((function(){return 7!=Object.defineProperty(St("div"),"a",{get:function(){return 7}}).a})),Et=Object.getOwnPropertyDescriptor,Pt={f:l?Et:function(t,e){if(t=A(t),e=gt(e),jt)try{return Et(t,e)}catch(t){}if(ct(t,e))return y(!h(b.f,t,e),t[e])}},xt=l&&f((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Tt=String,Rt=TypeError,Ct=function(t){if(U(t))return t;throw Rt(Tt(t)+" is not an object")},It=TypeError,_t=Object.defineProperty,At=Object.getOwnPropertyDescriptor,Mt={f:l?xt?function(t,e,n){if(Ct(t),e=gt(e),Ct(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var r=At(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return _t(t,e,n)}:_t:function(t,e,n){if(Ct(t),e=gt(e),Ct(n),jt)try{return _t(t,e,n)}catch(t){}if("get"in n||"set"in n)throw It("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},Ut=l?function(t,e,n){return Mt.f(t,e,y(1,n))}:function(t,e,n){return t[e]=n,t},Nt=Function.prototype,kt=l&&Object.getOwnPropertyDescriptor,Lt=ct(Nt,"name"),Ft={EXISTS:Lt,PROPER:Lt&&"something"===function(){}.name,CONFIGURABLE:Lt&&(!l||l&&kt(Nt,"name").configurable)},Bt=j(Function.toString);M(nt.inspectSource)||(nt.inspectSource=function(t){return Bt(t)});var Dt,qt,Wt,zt=nt.inspectSource,Qt=s.WeakMap,Gt=M(Qt)&&/native code/.test(zt(Qt)),Kt=rt("keys"),Xt=function(t){return Kt[t]||(Kt[t]=ft(t))},Yt={},Vt=s.TypeError,$t=s.WeakMap;if(Gt||nt.state){var Ht=nt.state||(nt.state=new $t),Jt=j(Ht.get),Zt=j(Ht.has),te=j(Ht.set);Dt=function(t,e){if(Zt(Ht,t))throw new Vt("Object already initialized");return e.facade=t,te(Ht,t,e),e},qt=function(t){return Jt(Ht,t)||{}},Wt=function(t){return Zt(Ht,t)}}else{var ee=Xt("state");Yt[ee]=!0,Dt=function(t,e){if(ct(t,ee))throw new Vt("Object already initialized");return e.facade=t,Ut(t,ee,e),e},qt=function(t){return ct(t,ee)?t[ee]:{}},Wt=function(t){return ct(t,ee)}}var ne={set:Dt,get:qt,has:Wt,enforce:function(t){return Wt(t)?qt(t):Dt(t,{})},getterFor:function(t){return function(e){var n;if(!U(e)||(n=qt(e)).type!==t)throw Vt("Incompatible receiver, "+t+" required");return n}}},re=i((function(t){var e=Ft.CONFIGURABLE,n=ne.enforce,r=ne.get,o=Object.defineProperty,i=l&&!f((function(){return 8!==o((function(){}),"length",{value:8}).length})),c=String(String).split("String"),u=t.exports=function(t,r,u){"Symbol("===String(r).slice(0,7)&&(r="["+String(r).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),u&&u.getter&&(r="get "+r),u&&u.setter&&(r="set "+r),(!ct(t,"name")||e&&t.name!==r)&&(l?o(t,"name",{value:r,configurable:!0}):t.name=r),i&&u&&ct(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&ct(u,"constructor")&&u.constructor?l&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var a=n(t);return ct(a,"source")||(a.source=c.join("string"==typeof r?r:"")),t};Function.prototype.toString=u((function(){return M(this)&&r(this).source||zt(this)}),"toString")})),oe=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(M(n)&&re(n,i,r),r.global)o?t[e]=n:et(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:Mt.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},ie=Math.ceil,ce=Math.floor,ue=Math.trunc||function(t){var e=+t;return(e>0?ce:ie)(e)},ae=function(t){var e=+t;return e!=e||0===e?0:ue(e)},se=Math.max,fe=Math.min,le=Math.min,pe=function(t){return(e=t.length)>0?le(ae(e),9007199254740991):0;var e},de=function(t){return function(e,n,r){var o,i=A(e),c=pe(i),u=function(t,e){var n=ae(t);return n<0?se(n+e,0):fe(n,e)}(r,c);if(t&&n!=n){for(;c>u;)if((o=i[u++])!=o)return!0}else for(;c>u;u++)if((t||u in i)&&i[u]===n)return t||u||0;return!t&&-1}},he={includes:de(!0),indexOf:de(!1)}.indexOf,ve=j([].push),me=function(t,e){var n,r=A(t),o=0,i=[];for(n in r)!ct(Yt,n)&&ct(r,n)&&ve(i,n);for(;e.length>o;)ct(r,n=e[o++])&&(~he(i,n)||ve(i,n));return i},be=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ye=be.concat("length","prototype"),ge={f:Object.getOwnPropertyNames||function(t){return me(t,ye)}},we={f:Object.getOwnPropertySymbols},Oe=j([].concat),Se=k("Reflect","ownKeys")||function(t){var e=ge.f(Ct(t)),n=we.f;return n?Oe(e,n(t)):e},je=function(t,e,n){for(var r=Se(e),o=Mt.f,i=Pt.f,c=0;c<r.length;c++){var u=r[c];ct(t,u)||n&&ct(n,u)||o(t,u,i(e,u))}},Ee=/#|\.prototype\./,Pe=function(t,e){var n=Te[xe(t)];return n==Ce||n!=Re&&(M(e)?f(e):!!e)},xe=Pe.normalize=function(t){return String(t).replace(Ee,".").toLowerCase()},Te=Pe.data={},Re=Pe.NATIVE="N",Ce=Pe.POLYFILL="P",Ie=Pe,_e=Pt.f,Ae=function(t,e){var n,r,o,i,c,u=t.target,a=t.global,f=t.stat;if(n=a?s:f?s[u]||et(u,{}):(s[u]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(c=_e(n,r))&&c.value:n[r],!Ie(a?r:u+(f?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;je(i,o)}(t.sham||o&&o.sham)&&Ut(i,"sham",!0),oe(n,r,i,t)}},Me={};Me[vt("toStringTag")]="z";var Ue,Ne="[object z]"===String(Me),ke=vt("toStringTag"),Le=Object,Fe="Arguments"==x(function(){return arguments}()),Be=Ne?x:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Le(t),ke))?n:Fe?x(e):"Object"==(r=x(e))&&M(e.callee)?"Arguments":r},De=String,qe=function(){var t=Ct(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},We=s.RegExp,ze=f((function(){var t=We("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),Qe=ze||f((function(){return!We("a","y").sticky})),Ge={BROKEN_CARET:ze||f((function(){var t=We("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:Qe,UNSUPPORTED_Y:ze},Ke=Object.keys||function(t){return me(t,be)},Xe=l&&!xt?Object.defineProperties:function(t,e){Ct(t);for(var n,r=A(e),o=Ke(e),i=o.length,c=0;i>c;)Mt.f(t,n=o[c++],r[n]);return t},Ye={f:Xe},Ve=k("document","documentElement"),$e=Xt("IE_PROTO"),He=function(){},Je=function(t){return"<script>"+t+"<\/script>"},Ze=function(t){t.write(Je("")),t.close();var e=t.parentWindow.Object;return t=null,e},tn=function(){try{Ue=new ActiveXObject("htmlfile")}catch(t){}var t,e;tn="undefined"!=typeof document?document.domain&&Ue?Ze(Ue):((e=St("iframe")).style.display="none",Ve.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Je("document.F=Object")),t.close(),t.F):Ze(Ue);for(var n=be.length;n--;)delete tn.prototype[be[n]];return tn()};Yt[$e]=!0;var en,nn,rn=Object.create||function(t,e){var n;return null!==t?(He.prototype=Ct(t),n=new He,He.prototype=null,n[$e]=t):n=tn(),void 0===e?n:Ye.f(n,e)},on=s.RegExp,cn=f((function(){var t=on(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)})),un=s.RegExp,an=f((function(){var t=un("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),sn=ne.get,fn=rt("native-string-replace",String.prototype.replace),ln=RegExp.prototype.exec,pn=ln,dn=j("".charAt),hn=j("".indexOf),vn=j("".replace),mn=j("".slice),bn=(nn=/b*/g,h(ln,en=/a/,"a"),h(ln,nn,"a"),0!==en.lastIndex||0!==nn.lastIndex),yn=Ge.BROKEN_CARET,gn=void 0!==/()??/.exec("")[1];(bn||gn||yn||cn||an)&&(pn=function(t){var e,n,r,o,i,c,u,a=this,s=sn(a),f=function(t){if("Symbol"===Be(t))throw TypeError("Cannot convert a Symbol value to a string");return De(t)}(t),l=s.raw;if(l)return l.lastIndex=a.lastIndex,e=h(pn,l,f),a.lastIndex=l.lastIndex,e;var p=s.groups,d=yn&&a.sticky,v=h(qe,a),m=a.source,b=0,y=f;if(d&&(v=vn(v,"y",""),-1===hn(v,"g")&&(v+="g"),y=mn(f,a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==dn(f,a.lastIndex-1))&&(m="(?: "+m+")",y=" "+y,b++),n=new RegExp("^(?:"+m+")",v)),gn&&(n=new RegExp("^"+m+"$(?!\\s)",v)),bn&&(r=a.lastIndex),o=h(ln,d?n:a,y),d?o?(o.input=mn(o.input,b),o[0]=mn(o[0],b),o.index=a.lastIndex,a.lastIndex+=o[0].length):a.lastIndex=0:bn&&o&&(a.lastIndex=a.global?o.index+o[0].length:r),gn&&o&&o.length>1&&h(fn,o[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&p)for(o.groups=c=rn(null),i=0;i<p.length;i++)c[(u=p[i])[0]]=o[u[1]];return o});Ae({target:"RegExp",proto:!0,forced:/./.exec!==pn},{exec:pn});var wn="process"==x(s.process),On=String,Sn=TypeError,jn=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=j(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return Ct(n),function(t){if("object"==typeof t||M(t))return t;throw Sn("Can't set "+On(t)+" as a prototype")}(r),e?t(n,r):n.__proto__=r,n}}():void 0),En=Mt.f,Pn=vt("toStringTag"),xn=vt("species"),Tn=TypeError,Rn=function(){},Cn=[],In=k("Reflect","construct"),_n=/^\s*(?:class|function)\b/,An=j(_n.exec),Mn=!_n.exec(Rn),Un=function(t){if(!M(t))return!1;try{return In(Rn,Cn,t),!0}catch(t){return!1}},Nn=function(t){if(!M(t))return!1;switch(Be(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Mn||!!An(_n,zt(t))}catch(t){return!0}};Nn.sham=!0;var kn,Ln,Fn,Bn,Dn=!In||f((function(){var t;return Un(Un.call)||!Un(Object)||!Un((function(){t=!0}))||t}))?Nn:Un,qn=TypeError,Wn=vt("species"),zn=function(t,e){var n,r=Ct(t).constructor;return void 0===r||null==(n=Ct(r)[Wn])?e:function(t){if(Dn(t))return t;throw qn(V(t)+" is not a constructor")}(n)},Qn=Function.prototype,Gn=Qn.apply,Kn=Qn.call,Xn="object"==typeof Reflect&&Reflect.apply||(p?Kn.bind(Gn):function(){return Kn.apply(Gn,arguments)}),Yn=j(j.bind),Vn=function(t,e){return H(t),void 0===e?t:p?Yn(t,e):function(){return t.apply(e,arguments)}},$n=j([].slice),Hn=TypeError,Jn=function(t,e){if(t<e)throw Hn("Not enough arguments");return t},Zn=/(?:ipad|iphone|ipod).*applewebkit/i.test(F),tr=s.setImmediate,er=s.clearImmediate,nr=s.process,rr=s.Dispatch,or=s.Function,ir=s.MessageChannel,cr=s.String,ur=0,ar={};try{kn=s.location}catch(t){}var sr=function(t){if(ct(ar,t)){var e=ar[t];delete ar[t],e()}},fr=function(t){return function(){sr(t)}},lr=function(t){sr(t.data)},pr=function(t){s.postMessage(cr(t),kn.protocol+"//"+kn.host)};tr&&er||(tr=function(t){Jn(arguments.length,1);var e=M(t)?t:or(t),n=$n(arguments,1);return ar[++ur]=function(){Xn(e,void 0,n)},Ln(ur),ur},er=function(t){delete ar[t]},wn?Ln=function(t){nr.nextTick(fr(t))}:rr&&rr.now?Ln=function(t){rr.now(fr(t))}:ir&&!Zn?(Bn=(Fn=new ir).port2,Fn.port1.onmessage=lr,Ln=Vn(Bn.postMessage,Bn)):s.addEventListener&&M(s.postMessage)&&!s.importScripts&&kn&&"file:"!==kn.protocol&&!f(pr)?(Ln=pr,s.addEventListener("message",lr,!1)):Ln="onreadystatechange"in St("script")?function(t){Ve.appendChild(St("script")).onreadystatechange=function(){Ve.removeChild(this),sr(t)}}:function(t){setTimeout(fr(t),0)});var dr,hr,vr,mr,br,yr,gr,wr,Or={set:tr,clear:er},Sr=/ipad|iphone|ipod/i.test(F)&&void 0!==s.Pebble,jr=/web0s(?!.*chrome)/i.test(F),Er=Pt.f,Pr=Or.set,xr=s.MutationObserver||s.WebKitMutationObserver,Tr=s.document,Rr=s.process,Cr=s.Promise,Ir=Er(s,"queueMicrotask"),_r=Ir&&Ir.value;_r||(dr=function(){var t,e;for(wn&&(t=Rr.domain)&&t.exit();hr;){e=hr.fn,hr=hr.next;try{e()}catch(t){throw hr?mr():vr=void 0,t}}vr=void 0,t&&t.enter()},Zn||wn||jr||!xr||!Tr?!Sr&&Cr&&Cr.resolve?((gr=Cr.resolve(void 0)).constructor=Cr,wr=Vn(gr.then,gr),mr=function(){wr(dr)}):wn?mr=function(){Rr.nextTick(dr)}:(Pr=Vn(Pr,s),mr=function(){Pr(dr)}):(br=!0,yr=Tr.createTextNode(""),new xr(dr).observe(yr,{characterData:!0}),mr=function(){yr.data=br=!br}));var Ar=_r||function(t){var e={fn:t,next:void 0};vr&&(vr.next=e),hr||(hr=e,mr()),vr=e},Mr=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Ur=function(){this.head=null,this.tail=null};Ur.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var Nr=Ur,kr=s.Promise,Lr="object"==typeof window&&"object"!=typeof Deno;kr&&kr.prototype;var Fr,Br,Dr,qr,Wr,zr,Qr=vt("species"),Gr=!1,Kr=M(s.PromiseRejectionEvent),Xr=Ie("Promise",(function(){var t=zt(kr),e=t!==String(kr);if(!e&&66===z)return!0;if(z>=51&&/native code/.test(t))return!1;var n=new kr((function(t){t(1)})),r=function(t){t((function(){}),(function(){}))};return(n.constructor={})[Qr]=r,!(Gr=n.then((function(){}))instanceof r)||!e&&Lr&&!Kr})),Yr={CONSTRUCTOR:Xr,REJECTION_EVENT:Kr,SUBCLASSING:Gr},Vr=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=H(e),this.reject=H(n)},$r={f:function(t){return new Vr(t)}},Hr=Or.set,Jr=Yr.CONSTRUCTOR,Zr=Yr.REJECTION_EVENT,to=Yr.SUBCLASSING,eo=ne.getterFor("Promise"),no=ne.set,ro=kr&&kr.prototype,oo=kr,io=ro,co=s.TypeError,uo=s.document,ao=s.process,so=$r.f,fo=so,lo=!!(uo&&uo.createEvent&&s.dispatchEvent),po=function(t){var e;return!(!U(t)||!M(e=t.then))&&e},ho=function(t,e){var n,r,o,i=e.value,c=1==e.state,u=c?t.ok:t.fail,a=t.resolve,s=t.reject,f=t.domain;try{u?(c||(2===e.rejection&&go(e),e.rejection=1),!0===u?n=i:(f&&f.enter(),n=u(i),f&&(f.exit(),o=!0)),n===t.promise?s(co("Promise-chain cycle")):(r=po(n))?h(r,n,a,s):a(n)):s(i)}catch(t){f&&!o&&f.exit(),s(t)}},vo=function(t,e){t.notified||(t.notified=!0,Ar((function(){for(var n,r=t.reactions;n=r.get();)ho(n,t);t.notified=!1,e&&!t.rejection&&bo(t)})))},mo=function(t,e,n){var r,o;lo?((r=uo.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),s.dispatchEvent(r)):r={promise:e,reason:n},!Zr&&(o=s["on"+t])?o(r):"unhandledrejection"===t&&function(t,e){var n=s.console;n&&n.error&&(1==arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)},bo=function(t){h(Hr,s,(function(){var e,n=t.facade,r=t.value;if(yo(t)&&(e=Mr((function(){wn?ao.emit("unhandledRejection",r,n):mo("unhandledrejection",n,r)})),t.rejection=wn||yo(t)?2:1,e.error))throw e.value}))},yo=function(t){return 1!==t.rejection&&!t.parent},go=function(t){h(Hr,s,(function(){var e=t.facade;wn?ao.emit("rejectionHandled",e):mo("rejectionhandled",e,t.value)}))},wo=function(t,e,n){return function(r){t(e,r,n)}},Oo=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=2,vo(t,!0))},So=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw co("Promise can't be resolved itself");var r=po(e);r?Ar((function(){var n={done:!1};try{h(r,e,wo(So,n,t),wo(Oo,n,t))}catch(e){Oo(n,e,t)}})):(t.value=e,t.state=1,vo(t,!1))}catch(e){Oo({done:!1},e,t)}}};if(Jr&&(io=(oo=function(t){!function(t,e){if(L(e,t))return t;throw Tn("Incorrect invocation")}(this,io),H(t),h(Fr,this);var e=eo(this);try{t(wo(So,e),wo(Oo,e))}catch(t){Oo(e,t)}}).prototype,(Fr=function(t){no(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new Nr,rejection:!1,state:0,value:void 0})}).prototype=oe(io,"then",(function(t,e){var n=eo(this),r=so(zn(this,oo));return n.parent=!0,r.ok=!M(t)||t,r.fail=M(e)&&e,r.domain=wn?ao.domain:void 0,0==n.state?n.reactions.add(r):Ar((function(){ho(r,n)})),r.promise})),Br=function(){var t=new Fr,e=eo(t);this.promise=t,this.resolve=wo(So,e),this.reject=wo(Oo,e)},$r.f=so=function(t){return t===oo||undefined===t?new Br(t):fo(t)},M(kr)&&ro!==Object.prototype)){Dr=ro.then,to||oe(ro,"then",(function(t,e){var n=this;return new oo((function(t,e){h(Dr,n,t,e)})).then(t,e)}),{unsafe:!0});try{delete ro.constructor}catch(t){}jn&&jn(ro,io)}Ae({global:!0,constructor:!0,wrap:!0,forced:Jr},{Promise:oo}),Wr="Promise",zr=!1,(qr=oo)&&!zr&&(qr=qr.prototype),qr&&!ct(qr,Pn)&&En(qr,Pn,{configurable:!0,value:Wr}),function(t){var e=k(t),n=Mt.f;l&&e&&!e[xn]&&n(e,xn,{configurable:!0,get:function(){return this}})}("Promise");var jo={},Eo=vt("iterator"),Po=Array.prototype,xo=vt("iterator"),To=function(t){if(null!=t)return J(t,xo)||J(t,"@@iterator")||jo[Be(t)]},Ro=TypeError,Co=function(t,e,n){var r,o;Ct(t);try{if(!(r=J(t,"return"))){if("throw"===e)throw n;return n}r=h(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return Ct(r),n},Io=TypeError,_o=function(t,e){this.stopped=t,this.result=e},Ao=_o.prototype,Mo=function(t,e,n){var r,o,i,c,u,a,s,f,l=n&&n.that,p=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),v=!(!n||!n.IS_ITERATOR),m=!(!n||!n.INTERRUPTED),b=Vn(e,l),y=function(t){return r&&Co(r,"normal",t),new _o(!0,t)},g=function(t){return p?(Ct(t),m?b(t[0],t[1],y):b(t[0],t[1])):m?b(t,y):b(t)};if(d)r=t.iterator;else if(v)r=t;else{if(!(o=To(t)))throw Io(V(t)+" is not iterable");if(void 0!==(f=o)&&(jo.Array===f||Po[Eo]===f)){for(i=0,c=pe(t);c>i;i++)if((u=g(t[i]))&&L(Ao,u))return u;return new _o(!1)}r=function(t,e){var n=arguments.length<2?To(t):e;if(H(n))return Ct(h(n,t));throw Ro(V(t)+" is not iterable")}(t,o)}for(a=d?t.next:r.next;!(s=h(a,r)).done;){try{u=g(s.value)}catch(t){Co(r,"throw",t)}if("object"==typeof u&&u&&L(Ao,u))return u}return new _o(!1)},Uo=vt("iterator"),No=!1;try{var ko=0,Lo={next:function(){return{done:!!ko++}},return:function(){No=!0}};Lo[Uo]=function(){return this},Array.from(Lo,(function(){throw 2}))}catch(t){}var Fo=Yr.CONSTRUCTOR||!function(t,e){if(!e&&!No)return!1;var n=!1;try{var r={};r[Uo]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n}((function(t){kr.all(t).then(void 0,(function(){}))}));Ae({target:"Promise",stat:!0,forced:Fo},{all:function(t){var e=this,n=$r.f(e),r=n.resolve,o=n.reject,i=Mr((function(){var n=H(e.resolve),i=[],c=0,u=1;Mo(t,(function(t){var a=c++,s=!1;u++,h(n,e,t).then((function(t){s||(s=!0,i[a]=t,--u||r(i))}),o)})),--u||r(i)}));return i.error&&o(i.value),n.promise}});var Bo=Yr.CONSTRUCTOR,Do=kr&&kr.prototype;if(Ae({target:"Promise",proto:!0,forced:Bo,real:!0},{catch:function(t){return this.then(void 0,t)}}),M(kr)){var qo=k("Promise").prototype.catch;Do.catch!==qo&&oe(Do,"catch",qo,{unsafe:!0})}Ae({target:"Promise",stat:!0,forced:Fo},{race:function(t){var e=this,n=$r.f(e),r=n.reject,o=Mr((function(){var o=H(e.resolve);Mo(t,(function(t){h(o,e,t).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}}),Ae({target:"Promise",stat:!0,forced:Yr.CONSTRUCTOR},{reject:function(t){var e=$r.f(this);return h(e.reject,void 0,t),e.promise}});var Wo=Yr.CONSTRUCTOR;k("Promise"),Ae({target:"Promise",stat:!0,forced:Wo},{resolve:function(t){return function(t,e){if(Ct(t),U(e)&&e.constructor===t)return e;var n=$r.f(t);return(0,n.resolve)(e),n.promise}(this,t)}});var zo=function(){var t=navigator.userAgent;return{baiduspider:/Baiduspider/.test(t),QQLive:/QQLive/i.test(t),mqq:/QQ\/([\d\.]+)/i.test(t),weibo:/Weibo/i.test(t),MicroMessenger:/MicroMessenger/i.test(t),mbaidu:/baiduboxapp/i.test(t),iqiyi:/iqiyi/i.test(t),qq:/MQQBrowser/i.test(t),mobile:/AppleWebKit.*Mobile.*/i.test(t),uc:/UCBrowser/i.test(t),xiaomiqjs:/MiuiQuickSearchBox/.test(t),dianping:/dianping/.test(t),ios:/\(i[^;]+;( U;)? CPU.+Mac OS X/i.test(t),android:/Android/i.test(t)||/Linux/i.test(t),windowsphone:/Windows Phone/i.test(t),iPhone:/iPhone/i.test(t),iPad:/iPad/i.test(t),webApp:!/Safari/i.test(t),baidu:/Baidu/i.test(t),Youku:/youku/i.test(t),chrome:/CriOS/i.test(t),CMDC:/CMDC/i.test(t),BiliApp:/BiliApp/i.test(t)}};t();var Qo="undefined"==typeof window?"":window.navigator.userAgent,Go=/android|adr|linux/gi.test(Qo),Ko=/\(i[^;]+;( U;)? CPU.+Mac OS X/i.test(Qo),Xo="https://www.bilibili.com/blackboard/activity-XLNUvLvI6b.html",Yo="https://apps.apple.com/cn/app/%E5%BF%85%E5%89%AA/id1299589486",Vo="https://dl.hdslb.com/mobile/latest/bilistudio/android_bbs-master.apk",$o=null,Ho=function(t,e){return new Promise((function(o,i){(function(t){return new Promise((function(e,n){r(t).then((function(t){t?e(1):n(new Error("您的App版本太低，请升级至最新版本"))}))}))})(t).then((function(){n.callNative({method:t,data:e,callback:function(t){o(t)}})}),i)}))},Jo=function(t){return e?Go?(n=zo(),void(e&&n.android?Ho("utils.openWithBrowser",{url:Vo}).then((function(t){return 0===t.code||Promise.reject(new Error("下载失败"))})):n.ios&&(window.location.href=Yo))):Ho("biliapp.jumpToScheme",{url:t}):Promise.reject();var n},Zo=function(){(document.hidden||document.webkitHidden)&&$o&&clearTimeout($o)},ti=function(t,e){Go&&(location.href=t||Vo),Ko&&(location.href=e||Yo)},ei=function(){document.addEventListener("visibilitychange",Zo,!1),document.addEventListener("webkitvisibilitychange",Zo,!1),window.addEventListener("pagehide",Zo,!1)},ni=function(){document.removeEventListener("visibilitychange",Zo,!1),document.removeEventListener("webkitvisibilitychange",Zo,!1),window.removeEventListener("pagehide",Zo,!1)},ri=function(t){var n="bcut://",r=Yo,o=Vo,i="com.bilibili.studio",c=Xo,u="bcut-schema";return"string"==typeof t?n=t||n:t&&(n=t.schema||n,r=t.iosStoreURL||r,o=t.androidURL||o,i=t.packageName||i,c=t.middlePageURl||Xo,u=t.schemaType||"bcut-schema"),e?function(t,n){return e?Go?Ho("utils.isInstalled",{packageName:t}).then((function(t){return t&&t.isInstalled})):Ho("ability.canOpenApplication",{url:n}).then((function(t){return 0===t.code||-3!==t.code&&Promise.reject(new Error(t.errMsg))})):Promise.reject()}(i,n).then((function(t){return t?function(t,n){return void 0===n&&(n="bcut-schema"),e?"bcut-schema-page"===n?(location.href=Ko?"bilibili://uper/appTraffic?appName=com.bilibili.studio&appScheme="+encodeURIComponent("bcut://studio/web/?h5_url="+encodeURIComponent(t)):"bcut://studio/web/?h5_url="+encodeURIComponent(t),Promise.resolve()):Ho(Go?"ability.openScheme":"ability.openApplication",{url:t}).then((function(t){return 0===t.code||Promise.reject(new Error("应用唤醒失败"))})):Promise.reject()}(n,u):Jo(r)})):(function(t){var e=zo();if(e.MicroMessenger||e.mqq||e.weibo)return location.href=t.middlePageURl+"?schema="+t.schema,!1;location.href=t.schema,$o=setTimeout((function(){Go&&(location.href=t.androidURL),Ko&&(location.href=t.iosStoreURL)}),3e3)}({schema:n,androidURL:o,iosStoreURL:r,middlePageURl:c}),Promise.resolve())};export{ei as addEventListener,ti as immediateDownload,ri as openBcut,ni as removeEventListener};
